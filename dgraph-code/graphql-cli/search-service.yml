# Generated by cdk-threagile

threagile_version: 1.0.0
title: Search Service
data: 2022-09-15
author:
  name: Roberto Auro
  homepage: null
management_summary_comment: null
business_overview: null
technical_overview: null
business_criticality: critical
questions: {}
abuse_cases: {}
security_requirements: {}
tags_available:
  - service
  - empathy
  - search
  - non-root
  - datastore
  - prometheus
  - monitoring
  - elasticsearch
  - index
  - mongodb
  - configurations
  - zookeeper
  - legacy
  - s3
  - plugins
  - aws
  - redis
  - cache
  - play
  - tooling
  - ether
  - wotc
data_assets:
  prometheusData:
    id: prometheus-data
    description: Prometheus data
    usage: devops
    tags:
      - monitoring
      - prometheus
    origin: null
    owner: null
    quantity: many
    confidentiality: internal
    integrity: operational
    availability: operational
    justification_cia_rating: null
  searchESData:
    id: search-esdata
    description: Elasticsearch
    usage: business
    tags:
      - search
      - elasticsearch
    origin: Search Service
    owner: Houston Rockets
    quantity: many
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
  searchMongoDBData:
    id: search-mongo-dbdata
    description: Search MongoDB configurations
    usage: business
    tags:
      - search
      - configurations
      - mongodb
    origin: Search Service
    owner: Houston Rockets
    quantity: many
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
  searchZooKeeperData:
    id: search-zoo-keeper-data
    description: ZooKeeper legacy configurations
    usage: business
    tags:
      - search
      - configurations
      - zookeeper
    origin: Search Service
    owner: Houston Rockets
    quantity: many
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
  searchS3Data:
    id: search-s3-data
    description: S3 Plugins files
    usage: business
    tags:
      - search
      - plugins
      - s3
      - aws
    origin: Search Service
    owner: Rosetta
    quantity: very-few
    confidentiality: restricted
    integrity: critical
    availability: important
    justification_cia_rating: null
  searchRedisData:
    id: search-redis-data
    description: Search Redis cache
    usage: business
    tags:
      - search
      - redis
      - cache
    origin: Search Service
    owner: Houston Rockets
    quantity: many
    confidentiality: restricted
    integrity: critical
    availability: important
    justification_cia_rating: null
  searchPlayData:
    id: search-play-data
    description: Equalize data from Play
    usage: business
    tags:
      - search
      - play
      - tooling
    origin: Search Service
    owner: Play
    quantity: many
    confidentiality: restricted
    integrity: important
    availability: important
    justification_cia_rating: null
  searchContextualizeData:
    id: search-contextualize-data
    description: Contextualize data from Ether
    usage: business
    tags:
      - search
      - ether
      - wotc
    origin: Search Service
    owner: Ether
    quantity: many
    confidentiality: internal
    integrity: important
    availability: important
    justification_cia_rating: null
technical_assets:
  search-service:
    id: search-service
    description: Search Service
    type: process
    usage: business
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope: Out of scope
    size: service
    technology: web-service-rest
    tags:
      - service
      - empathy
      - search
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Search
    confidentiality: public
    integrity: mission-critical
    availability: mission-critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - prometheus-data
      - search-esdata
      - search-mongo-dbdata
      - search-zoo-keeper-data
      - search-s3-data
      - search-redis-data
      - search-play-data
      - search-contextualize-data
    data_assets_stored: []
    data_formats_accepted: null
    communication_links:
      prometheus2search-service:
        target: prometheus
        description: Prometheus to search-service service traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: devops
        data_assets_sent: []
        data_assets_received:
          - prometheus-data
      search-service2elasticsearch:
        target: elasticsearch
        description: Search to ES traffic
        protocol: http
        authentication: none
        authorization: technical-user
        vpn: false
        ipFiltered: false
        readonly: true
        usage: business
        data_assets_sent:
          - search-esdata
        data_assets_received: []
      search-service2search-mongodb:
        target: search-mongodb
        description: Search to MongoDB traffic
        protocol: nosql-access-protocol
        authentication: credentials
        authorization: technical-user
        vpn: false
        ipFiltered: false
        readonly: false
        usage: business
        data_assets_sent:
          - search-mongo-dbdata
        data_assets_received: []
      search-service2zoo-keeper:
        target: zoo-keeper
        description: Search to ZooKeeper traffic
        protocol: nosql-access-protocol
        authentication: credentials
        authorization: technical-user
        vpn: false
        ipFiltered: false
        readonly: true
        usage: business
        data_assets_sent:
          - search-zoo-keeper-data
        data_assets_received: []
      search-service2s3-plugins-bucket:
        target: s3-plugins-bucket
        description: Search to S3 traffic
        protocol: https
        authentication: session-id
        authorization: technical-user
        vpn: false
        ipFiltered: false
        readonly: true
        usage: business
        data_assets_sent:
          - search-s3-data
        data_assets_received: []
      search-service2redis:
        target: redis
        description: Search to Redis traffic
        protocol: nosql-access-protocol
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: false
        usage: business
        data_assets_sent:
          - search-redis-data
        data_assets_received: []
      search-service2play-service:
        target: play-service
        description: Search to Play traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: business
        data_assets_sent:
          - search-play-data
        data_assets_received: []
      search-service2contextualize-service:
        target: contextualize-service
        description: Search to Contextualize traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: business
        data_assets_sent:
          - search-contextualize-data
        data_assets_received: []
  Prometheus:
    id: prometheus
    description: Prometheus Cluster
    type: datastore
    usage: devops
    used_as_client_by_human: false
    out_of_scope: true
    justification_out_of_scope: Prometheus is not in the scope of the threat model
    size: system
    technology: monitoring
    tags:
      - datastore
      - prometheus
      - monitoring
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Platform
    confidentiality: internal
    integrity: operational
    availability: operational
    justification_cia_rating: null
    multi_tenant: false
    redundant: true
    custom_developed_parts: false
    data_assets_processed: []
    data_assets_stored:
      - prometheus-data
    data_formats_accepted: null
    communication_links: {}
  Elasticsearch:
    id: elasticsearch
    description: ""
    type: datastore
    usage: business
    used_as_client_by_human: false
    out_of_scope: true
    justification_out_of_scope: Out of scope
    size: component
    technology: search-index
    tags:
      - datastore
      - elasticsearch
      - index
      - search
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Houston Rockets
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - search-esdata
    data_assets_stored: []
    data_formats_accepted: null
    communication_links: {}
  search-mongodb:
    id: search-mongodb
    description: Search MongoDB
    type: datastore
    usage: business
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope: Out of scope
    size: component
    technology: database
    tags:
      - datastore
      - mongodb
      - configurations
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Houston Rockets
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - prometheus-data
    data_assets_stored:
      - search-mongo-dbdata
    data_formats_accepted: null
    communication_links:
      prometheus2search-mongodb:
        target: prometheus
        description: Prometheus to search-mongodb service traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: devops
        data_assets_sent: []
        data_assets_received:
          - prometheus-data
  ZooKeeper:
    id: zoo-keeper
    description: ZooKeeper for legacy configurations
    type: datastore
    usage: business
    used_as_client_by_human: false
    out_of_scope: true
    justification_out_of_scope: Out of scope
    size: component
    technology: database
    tags:
      - datastore
      - zookeeper
      - configurations
      - legacy
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Houston Rockets
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed: []
    data_assets_stored:
      - search-zoo-keeper-data
    data_formats_accepted: null
    communication_links: {}
  S3PluginsBucket:
    id: s3-plugins-bucket
    description: S3 bucket for plugins
    type: datastore
    usage: business
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope: Out of scope
    size: component
    technology: block-storage
    tags:
      - datastore
      - s3
      - plugins
      - aws
      - non-root
    internet: false
    machine: serverless
    encryption: data-with-asymmetric-shared-key
    owner: Search
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - prometheus-data
    data_assets_stored:
      - search-s3-data
    data_formats_accepted: null
    communication_links:
      prometheus2s3-plugins-bucket:
        target: prometheus
        description: Prometheus to s3-plugins-bucket service traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: devops
        data_assets_sent: []
        data_assets_received:
          - prometheus-data
  Redis:
    id: redis
    description: Redis cache
    type: datastore
    usage: business
    used_as_client_by_human: false
    out_of_scope: false
    justification_out_of_scope: Out of scope
    size: component
    technology: database
    tags:
      - datastore
      - redis
      - cache
      - aws
      - non-root
    internet: false
    machine: serverless
    encryption: none
    owner: Houston Rockets
    confidentiality: restricted
    integrity: critical
    availability: important
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - prometheus-data
    data_assets_stored:
      - search-redis-data
    data_formats_accepted: null
    communication_links:
      prometheus2redis:
        target: prometheus
        description: Prometheus to redis service traffic
        protocol: http
        authentication: none
        authorization: none
        vpn: false
        ipFiltered: false
        readonly: true
        usage: devops
        data_assets_sent: []
        data_assets_received:
          - prometheus-data
  play-service:
    id: play-service
    description: Play Service
    type: process
    usage: business
    used_as_client_by_human: false
    out_of_scope: true
    justification_out_of_scope: Out of scope
    size: service
    technology: web-service-rest
    tags:
      - service
      - empathy
      - play
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Play
    confidentiality: restricted
    integrity: critical
    availability: critical
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - search-play-data
    data_assets_stored: []
    data_formats_accepted: null
    communication_links: {}
  contextualize-service:
    id: contextualize-service
    description: Contextualize Service
    type: process
    usage: business
    used_as_client_by_human: false
    out_of_scope: true
    justification_out_of_scope: Context service is out of scope
    size: service
    technology: web-service-rest
    tags:
      - service
      - empathy
      - ether
      - non-root
    internet: false
    machine: container
    encryption: none
    owner: Ether
    confidentiality: internal
    integrity: important
    availability: important
    justification_cia_rating: null
    multi_tenant: true
    redundant: true
    custom_developed_parts: false
    data_assets_processed:
      - search-contextualize-data
    data_assets_stored: []
    data_formats_accepted: null
    communication_links: {}
trust_boundaries:
  VPCNetwork:
    id: vpcnetwork
    description: internal network
    type: network-cloud-provider
    tags: []
    technical_assets_inside: []
    trust_boundaries_nested:
      - k8s-network
  K8sNetwork:
    id: k8s-network
    description: internal k8s
    type: network-dedicated-hoster
    tags: []
    technical_assets_inside:
      - search-service
      - prometheus
      - elasticsearch
      - search-mongodb
      - zoo-keeper
      - play-service
      - contextualize-service
    trust_boundaries_nested: []
shared_runtimes:
  K8sRuntime:
    id: k8s-runtime
    description: Kubernetes Cluster
    tags: []
    technical_assets_running:
      - search-service
      - prometheus
      - elasticsearch
      - search-mongodb
      - zoo-keeper
      - play-service
      - contextualize-service
individual_risk_categories: {}
risk_tracking:
  missing-cloud-hardening@*:
    status: accepted
    justification: external service
    ticket: ""
    date: null
    checked_by: null
  use-of-weak-cryptography-in-transit@*:
    status: accepted
    justification: external service
    ticket: ""
    date: null
    checked_by: null
